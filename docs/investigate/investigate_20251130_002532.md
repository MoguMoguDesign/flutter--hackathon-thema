# INVESTIGATE Phase Report: Issue #38

**èª¿æŸ»æ—¥æ™‚**: 2025-11-30
**Issue**: #38 feat(haiku): ä¿³å¥å…¥åŠ›å®Œäº†æ™‚ã«Firestoreã¸éåŒæœŸä¿å­˜
**èª¿æŸ»è€…**: Claude Code
**ãƒ•ã‚§ãƒ¼ã‚º**: INVESTIGATE

---

## 1. Executive Summary

### èª¿æŸ»æ¦‚è¦
Issue #38ã§ææ¡ˆã•ã‚Œã¦ã„ã‚‹ã€Œä¿³å¥å…¥åŠ›å®Œäº†æ™‚ã®FirestoreéåŒæœŸä¿å­˜æ©Ÿèƒ½ã€ã®å®Ÿè£…å¯èƒ½æ€§ã¨å½±éŸ¿ç¯„å›²ã‚’èª¿æŸ»ã—ã¾ã—ãŸã€‚

### ä¸»è¦ãªç™ºè¦‹äº‹é …
1. ç¾åœ¨ã®`HaikuInputPage`ã¯ç”»é¢é·ç§»ã®ã¿ã‚’å®Ÿè¡Œã—ã€ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–æ©Ÿèƒ½ãªã—
2. æ—¢å­˜ã®`FirestoreRepository<T>`åŸºåº•ã‚¯ãƒ©ã‚¹ãŒåˆ©ç”¨å¯èƒ½ã§ã€å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç¢ºç«‹æ¸ˆã¿
3. `haiku`ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã«ã¯`presentation`å±¤ã®ã¿å­˜åœ¨ã—ã€`data`å±¤ã¨`service`å±¤ãŒæœªå®Ÿè£…
4. Riverpod 3.x (`@riverpod`ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³)ã¨Freezedã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç¢ºç«‹æ¸ˆã¿
5. åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³(unit/widget)ãŒæ•´å‚™æ¸ˆã¿

### æ¨å¥¨äº‹é …
**å®Ÿè£…ã‚’æ¨å¥¨ã—ã¾ã™**ã€‚æ—¢å­˜ã‚¤ãƒ³ãƒ•ãƒ©ã¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒªã‚¹ã‚¯ã‚’æœ€å°é™ã«æŠ‘ãˆãŸå®Ÿè£…ãŒå¯èƒ½ã§ã™ã€‚

---

## 2. Issue #38 è©³ç´°åˆ†æ

### Issueæ¦‚è¦
- **ã‚¿ã‚¤ãƒˆãƒ«**: feat(haiku): ä¿³å¥å…¥åŠ›å®Œäº†æ™‚ã«Firestoreã¸éåŒæœŸä¿å­˜
- **URL**: https://github.com/MoguMoguDesign/flutter--hackathon-thema/issues/38
- **ã‚¿ã‚¤ãƒ—**: enhancement (æ–°æ©Ÿèƒ½)

### èƒŒæ™¯ã¨ç›®çš„
**ç¾çŠ¶ã®å•é¡Œ**:
- ä¿³å¥å…¥åŠ›ç”»é¢ã§3è¡Œå…¥åŠ›å®Œäº†å¾Œã€`GeneratingRoute`ã¸ã®ç”»é¢é·ç§»ã®ã¿å®Ÿè¡Œ
- å…¥åŠ›ã•ã‚ŒãŸä¿³å¥ãƒ‡ãƒ¼ã‚¿ãŒFirestoreã«ä¿å­˜ã•ã‚Œãšã€æ°¸ç¶šåŒ–ã•ã‚Œãªã„
- å°†æ¥çš„ãªä¿³å¥å±¥æ­´è¡¨ç¤ºã‚„ç·¨é›†æ©Ÿèƒ½ã®åŸºç›¤ãŒä¸è¶³

**æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã—ãŸä¿³å¥ã®ç¢ºå®Ÿãªä¿å­˜
- AIç”Ÿæˆç”»åƒã¨ä¿³å¥ãƒ‡ãƒ¼ã‚¿ã®ç´ä»˜ã‘
- å°†æ¥çš„ãªæ©Ÿèƒ½æ‹¡å¼µ(å±¥æ­´è¡¨ç¤ºã€ç·¨é›†ã€å‰Šé™¤)ã®åŸºç›¤æ§‹ç¯‰

### ææ¡ˆã•ã‚Œã¦ã„ã‚‹æŠ€è¡“ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
1. **ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«**: Freezedã«ã‚ˆã‚‹`HaikuModel`ã®ä½œæˆ
2. **ãƒªãƒã‚¸ãƒˆãƒª**: `FirestoreRepository<HaikuModel>`ã‚’ç¶™æ‰¿ã—ãŸ`HaikuRepository`
3. **çŠ¶æ…‹ç®¡ç†**: `@riverpod`ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹`HaikuNotifier`ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
4. **éåŒæœŸå‡¦ç†**: `unawaited()`ã‚’ä½¿ç”¨ã—ãŸUIãƒãƒ³ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ä¿å­˜
5. **ç”»é¢çµ±åˆ**: `HaikuInputPage.handleNext()`ãƒ¡ã‚½ãƒƒãƒ‰ã®ä¿®æ­£

---

## 3. ç¾åœ¨ã®å®Ÿè£…åˆ†æ

### 3.1 HaikuInputPage ã®ç¾çŠ¶

**ãƒ•ã‚¡ã‚¤ãƒ«**: `lib/features/haiku/presentation/pages/haiku_input_page.dart`

**ä¸»è¦æ©Ÿèƒ½**:
- 3ã‚¹ãƒ†ãƒƒãƒ—å½¢å¼ã®ä¿³å¥å…¥åŠ›(ä¸Šã®å¥ã€çœŸã‚“ä¸­ã®è¡Œã€ä¸‹ã®å¥)
- å„è¡Œ10æ–‡å­—ä»¥å†…ã®å…¥åŠ›åˆ¶é™
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- `HaikuPreview`ã«ã‚ˆã‚‹ç¸¦æ›¸ããƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
- ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã«ã‚ˆã‚‹é€²æ—è¡¨ç¤º

**ç”»é¢é·ç§»å‡¦ç†** (L55-L82):
```dart
void handleNext() {
  final text = inputController.text.trim();
  if (text.isEmpty) return;

  switch (currentStep.value) {
    case 0: firstLine.value = text;
    case 1: secondLine.value = text;
    case 2: thirdLine.value = text;
  }

  if (currentStep.value < 2) {
    currentStep.value++;
    inputController.clear();
    isValid.value = false;
  } else {
    // â˜… ã“ã“ã§Firestoreä¿å­˜å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
    GeneratingRoute(
      firstLine: firstLine.value,
      secondLine: secondLine.value,
      thirdLine: thirdLine.value,
    ).go(context);
  }
}
```

**å•é¡Œç‚¹**:
- ã‚¹ãƒ†ãƒƒãƒ—2å®Œäº†æ™‚ã€å³åº§ã«`GeneratingRoute`ã¸é·ç§»
- ä¿³å¥ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–å‡¦ç†ãŒå­˜åœ¨ã—ãªã„
- ãƒ¡ãƒ¢ãƒªä¸Šã«ã®ã¿ãƒ‡ãƒ¼ã‚¿ãŒä¿æŒã•ã‚Œã€ã‚¢ãƒ—ãƒªçµ‚äº†æ™‚ã«æ¶ˆå¤±

### 3.2 GeneratingPage ã®ç¾çŠ¶

**ãƒ•ã‚¡ã‚¤ãƒ«**: `lib/features/haiku/presentation/pages/generating_page.dart`

**ä¸»è¦æ©Ÿèƒ½**:
- ä¿³å¥3è¡Œã‚’ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å—ã‘å–ã‚‹
- AIç”»åƒç”Ÿæˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³(ç¾åœ¨ã¯ãƒ¢ãƒƒã‚¯å®Ÿè£…)
- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼è¡¨ç¤º
- å®Œäº†å¾Œ`PreviewRoute`ã¸è‡ªå‹•é·ç§»

**ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼**:
```
HaikuInputPage â†’ GeneratingRoute(ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿) â†’ GeneratingPage â†’ PreviewRoute(ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿)
```

**æ³¨æ„ç‚¹**:
- ç¾åœ¨ã¯ç”»é¢é–“ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ä¿³å¥ãƒ‡ãƒ¼ã‚¿ã‚’å¼•ãå›ã—ã¦ã„ã‚‹
- Firestoreã¸ã®ä¿å­˜ã¯æœªå®Ÿè£…
- AIç”Ÿæˆå‡¦ç†ã‚‚ç¾åœ¨ã¯ãƒ¢ãƒƒã‚¯(Issue #38ã¨ã¯åˆ¥ã®ã‚¿ã‚¹ã‚¯)

### 3.3 Haiku ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

**ç¾çŠ¶**:
```
lib/features/haiku/
â””â”€â”€ presentation/
    â”œâ”€â”€ pages/
    â”‚   â”œâ”€â”€ generating_page.dart
    â”‚   â”œâ”€â”€ haiku_input_page.dart
    â”‚   â””â”€â”€ preview_page.dart
    â””â”€â”€ widgets/
        â”œâ”€â”€ haiku_preview.dart
        â””â”€â”€ step_indicator.dart
```

**ä¸è¶³ã—ã¦ã„ã‚‹å±¤**:
- `data/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (models, repositories)
- `service/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯)

**å¿…è¦ãªè¿½åŠ æ§‹é€ **:
```
lib/features/haiku/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ haiku_model.dart
â”‚   â”‚   â”œâ”€â”€ haiku_model.freezed.dart  (ç”Ÿæˆ)
â”‚   â”‚   â””â”€â”€ haiku_model.g.dart        (ç”Ÿæˆ)
â”‚   â””â”€â”€ repositories/
â”‚       â”œâ”€â”€ haiku_repository.dart
â”‚       â””â”€â”€ haiku_repository.g.dart   (ç”Ÿæˆ)
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ providers/                    (æ–°è¦)
â”‚   â”‚   â”œâ”€â”€ haiku_provider.dart
â”‚   â”‚   â””â”€â”€ haiku_provider.g.dart     (ç”Ÿæˆ)
â”‚   â”œâ”€â”€ pages/                        (æ—¢å­˜)
â”‚   â””â”€â”€ widgets/                      (æ—¢å­˜)
â””â”€â”€ service/                          (å°†æ¥çš„ã«å¿…è¦)
```

---

## 4. æ—¢å­˜ã‚¤ãƒ³ãƒ•ãƒ©ã¨ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ

### 4.1 Firestore ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³

**åŸºåº•ã‚¯ãƒ©ã‚¹**: `lib/shared/data/repositories/firestore_repository.dart`

**ç‰¹å¾´**:
- ã‚¸ã‚§ãƒãƒªãƒƒã‚¯å‹`<T>`ã«ã‚ˆã‚‹å‹å®‰å…¨ãªå®Ÿè£…
- CRUDæ“ä½œã®å®Œå…¨ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹æä¾›
- ã‚¹ãƒˆãƒªãƒ¼ãƒ (`watchAll`, `watch`)ã‚µãƒãƒ¼ãƒˆ
- ãƒ†ã‚¹ãƒˆå¯èƒ½ãªè¨­è¨ˆ(`@protected FirebaseFirestore get firestore`)

**ä½¿ç”¨ä¾‹ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```dart
abstract class FirestoreRepository<T> {
  FirestoreRepository({required this.collectionPath});

  final String collectionPath;

  @protected
  FirebaseFirestore get firestore => FirebaseService.firestore;

  // ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§å®Ÿè£…
  T fromFirestore(DocumentSnapshot<Map<String, dynamic>> snapshot);
  Map<String, dynamic> toFirestore(T data);

  // æä¾›ã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰
  Future<String> create(T data, {String? docId});
  Future<T?> read(String docId);
  Future<void> update(String docId, T data);
  Future<void> delete(String docId);
  Future<List<T>> readAll();
  Stream<List<T>> watchAll({Query? query});
  Stream<T?> watch(String docId);
}
```

**å®Ÿè£…æ™‚ã®è¦ä»¶**:
1. ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ã‚¹ã®æŒ‡å®š
2. `fromFirestore()`ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
3. `toFirestore()`ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…

### 4.2 Riverpod ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³

**å‚è€ƒå®Ÿè£…**: `lib/app/app_di/nickname_provider.dart`

**ãƒ‘ã‚¿ãƒ¼ãƒ³ç‰¹å¾´**:
- `@Riverpod`ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
- `riverpod_annotation`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½¿ç”¨
- `part 'xxx.g.dart'`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–
- `_$ClassName`ç¶™æ‰¿ãƒ‘ã‚¿ãƒ¼ãƒ³

**å®Ÿè£…ä¾‹**:
```dart
import 'package:riverpod_annotation/riverpod_annotation.dart';

part 'nickname_provider.g.dart';

@Riverpod(keepAlive: true)
class TemporaryNickname extends _$TemporaryNickname {
  @override
  String? build() {
    return null;
  }

  void setNickname(String nickname) {
    state = nickname;
  }
}
```

**Issue #38ã§ã®é©ç”¨**:
- `@riverpod`ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§`HaikuNotifier`ã‚’å®šç¾©
- `AsyncValue<void>`ã«ã‚ˆã‚‹éåŒæœŸçŠ¶æ…‹ç®¡ç†
- `saveHaiku()`ãƒ¡ã‚½ãƒƒãƒ‰ã§Firestoreä¿å­˜å‡¦ç†

### 4.3 ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³

**ç¾çŠ¶**: æ—¢å­˜ã®`Post`ãƒ¢ãƒ‡ãƒ«ã¯Freezedã‚’ä½¿ç”¨ã—ã¦ã„ãªã„
```dart
class Post {
  const Post({
    required this.id,
    required this.nickname,
    required this.haiku,
    // ...
  });
  // æ‰‹å‹•å®Ÿè£…
}
```

**Issue #38ã§ã®æ¡ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³**: Freezed + json_serializable
```dart
@freezed
class HaikuModel with _$HaikuModel {
  const factory HaikuModel({
    required String id,
    required String firstLine,
    required String secondLine,
    required String thirdLine,
    required DateTime createdAt,
    String? imageUrl,
    String? userId,
  }) = _HaikuModel;

  factory HaikuModel.fromJson(Map<String, dynamic> json) =>
      _$HaikuModelFromJson(json);
}
```

**ç†ç”±**:
- `pubspec.yaml`ã«`freezed`ã¨`json_serializable`ãŒæ—¢ã«å«ã¾ã‚Œã¦ã„ã‚‹
- ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã«ã‚ˆã‚‹å‹å®‰å…¨æ€§ã¨ä¿å®ˆæ€§ã®å‘ä¸Š
- `toJson()`/`fromJson()`ã®è‡ªå‹•ç”Ÿæˆ
- ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªè¨­è¨ˆ

### 4.4 ãƒ†ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³

**å‚è€ƒãƒ†ã‚¹ãƒˆ**: `test/shared/data/repositories/firestore_repository_test.dart`

**ãƒ†ã‚¹ãƒˆæˆ¦ç•¥**:
1. `fake_cloud_firestore`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½¿ç”¨
2. ãƒ†ã‚¹ãƒˆç”¨ãƒ¢ãƒ‡ãƒ«ã¨ãƒªãƒã‚¸ãƒˆãƒªã®ä½œæˆ
3. å„CRUDãƒ¡ã‚½ãƒƒãƒ‰ã®åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ
4. ã‚¹ãƒˆãƒªãƒ¼ãƒ æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**:
- `create()`: è‡ªå‹•ç”ŸæˆIDã€ã‚«ã‚¹ã‚¿ãƒ ID
- `read()`: å­˜åœ¨ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€å­˜åœ¨ã—ãªã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `update()`: æ—¢å­˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ›´æ–°
- `delete()`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å‰Šé™¤
- `readAll()`: å…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå–å¾—ã€ç©ºã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
- `watchAll()`: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
- `watch()`: ç‰¹å®šãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç›£è¦–

**Issue #38ã§ã®é©ç”¨**:
```dart
class HaikuRepository extends FirestoreRepository<HaikuModel> {
  HaikuRepository({required FakeFirebaseFirestore fakeFirestore})
      : _fakeFirestore = fakeFirestore,
        super(collectionPath: 'haikus');

  final FakeFirebaseFirestore _fakeFirestore;

  @override
  FirebaseFirestore get firestore => _fakeFirestore;

  // ...
}
```

---

## 5. ä¸‰å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æº–æ‹ æ€§ã®æ¤œè¨¼

### 5.1 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¸‰å±¤æ§‹é€ **:
```
App Layer (ã‚¢ãƒ—ãƒªå±¤)
  â†“ depends on
Feature Layer (æ©Ÿèƒ½å±¤)
  â†“ depends on
Shared Layer (å…±æœ‰å±¤)
```

**é‡è¦ãªåˆ¶ç´„**:
- âœ… App â†’ Feature, App â†’ Shared (è¨±å¯)
- âœ… Feature â†’ Shared (è¨±å¯)
- âŒ Feature â†’ Feature (ç¦æ­¢: ç›´æ¥ä¾å­˜)
- âŒ Shared â†’ Feature, Shared â†’ App (ç¦æ­¢)
- âŒ å¾ªç’°ä¾å­˜ (ç¦æ­¢)

### 5.2 Issue #38ã®å®Ÿè£…ã«ãŠã‘ã‚‹ä¾å­˜é–¢ä¿‚

**æ–°è¦ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä¾å­˜é–¢ä¿‚**:

1. **HaikuModel** (`lib/features/haiku/data/models/haiku_model.dart`)
   ```
   ä¾å­˜: freezed_annotation, json_annotation (å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸)
   ä¾å­˜ãƒ¬ã‚¤ãƒ¤ãƒ¼: ãªã—
   æº–æ‹ : âœ… ãƒ¢ãƒ‡ãƒ«ã¯ä¾å­˜ãªã—ã§å®Ÿè£…å¯èƒ½
   ```

2. **HaikuRepository** (`lib/features/haiku/data/repositories/haiku_repository.dart`)
   ```
   ä¾å­˜: FirestoreRepository<T> (Sharedå±¤)
   ä¾å­˜: HaikuModel (åŒã˜Featureå†…)
   ä¾å­˜: cloud_firestore (å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸)
   æº–æ‹ : âœ… Feature â†’ Shared ã®ä¾å­˜ã¯è¨±å¯ã•ã‚Œã¦ã„ã‚‹
   ```

3. **HaikuNotifier** (`lib/features/haiku/presentation/providers/haiku_provider.dart`)
   ```
   ä¾å­˜: HaikuRepository (åŒã˜Featureå†…)
   ä¾å­˜: riverpod_annotation (å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸)
   æº–æ‹ : âœ… Featureå†…éƒ¨ã®ä¾å­˜ã¯å•é¡Œãªã—
   ```

4. **HaikuInputPage** (ä¿®æ­£)
   ```
   ä¾å­˜: HaikuNotifier (åŒã˜Featureå†…)
   ä¾å­˜: async package (unawaited)
   æº–æ‹ : âœ… Featureå†…éƒ¨ã®ä¾å­˜ã¯å•é¡Œãªã—
   ```

**çµè«–**: Issue #38ã®å®Ÿè£…ã¯ä¸‰å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«å®Œå…¨æº–æ‹ ã—ã¦ã„ã¾ã™ã€‚

### 5.3 ä¾å­˜é–¢ä¿‚ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  App Layer                                      â”‚
â”‚  - app_router/routes.dart                       â”‚
â”‚  - app_di/ (ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Feature Layer: haiku                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ presentation/                             â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ providers/                           â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€â”€ haiku_provider.dart â”€â”€â”€â”€â”       â”‚  â”‚
â”‚  â”‚  â””â”€â”€ pages/                       â”‚       â”‚  â”‚
â”‚  â”‚      â””â”€â”€ haiku_input_page.dart â”€â”€â”€â”˜       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â†“                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ data/                                     â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ repositories/                        â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€â”€ haiku_repository.dart â”€â”€â”       â”‚  â”‚
â”‚  â”‚  â””â”€â”€ models/                      â”‚       â”‚  â”‚
â”‚  â”‚      â””â”€â”€ haiku_model.dart â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Shared Layer                                   â”‚
â”‚  - data/repositories/firestore_repository.dart  â”‚
â”‚  - service/firebase_service.dart                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¾å­˜ã®æµã‚Œ**:
1. `HaikuInputPage` â†’ `HaikuNotifier` (Featureå†…)
2. `HaikuNotifier` â†’ `HaikuRepository` (Featureå†…)
3. `HaikuRepository` â†’ `FirestoreRepository<T>` (Feature â†’ Shared: âœ…)
4. `HaikuRepository` â†’ `HaikuModel` (Featureå†…)

**å¤–éƒ¨ã¸ã®å½±éŸ¿ãªã—**: ã“ã®å®Ÿè£…ã¯haikuãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼å†…ã§å®Œçµã—ã€ä»–ã®ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã¸ã®å½±éŸ¿ã¯ã‚¼ãƒ­ã§ã™ã€‚

---

## 6. å®Ÿè£…å½±éŸ¿ç¯„å›²ã®è©•ä¾¡

### 6.1 æ–°è¦ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | ç›®çš„ | ç”Ÿæˆã®æœ‰ç„¡ |
|------------|------|----------|
| `lib/features/haiku/data/models/haiku_model.dart` | ä¿³å¥ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å®šç¾© | æ‰‹å‹• |
| `lib/features/haiku/data/models/haiku_model.freezed.dart` | Freezedç”Ÿæˆã‚³ãƒ¼ãƒ‰ | è‡ªå‹•ç”Ÿæˆ |
| `lib/features/haiku/data/models/haiku_model.g.dart` | json_serializableç”Ÿæˆã‚³ãƒ¼ãƒ‰ | è‡ªå‹•ç”Ÿæˆ |
| `lib/features/haiku/data/repositories/haiku_repository.dart` | Firestoreãƒªãƒã‚¸ãƒˆãƒª | æ‰‹å‹• |
| `lib/features/haiku/presentation/providers/haiku_provider.dart` | Riverpodãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ | æ‰‹å‹• |
| `lib/features/haiku/presentation/providers/haiku_provider.g.dart` | riverpod_generatorç”Ÿæˆã‚³ãƒ¼ãƒ‰ | è‡ªå‹•ç”Ÿæˆ |

**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**:
| ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | ç›®çš„ | ç”Ÿæˆã®æœ‰ç„¡ |
|------------|------|----------|
| `test/features/haiku/data/models/haiku_model_test.dart` | ãƒ¢ãƒ‡ãƒ«ã®ãƒ†ã‚¹ãƒˆ | æ‰‹å‹• |
| `test/features/haiku/data/repositories/haiku_repository_test.dart` | ãƒªãƒã‚¸ãƒˆãƒªã®ãƒ†ã‚¹ãƒˆ | æ‰‹å‹• |
| `test/features/haiku/presentation/providers/haiku_provider_test.dart` | ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒ†ã‚¹ãƒˆ | æ‰‹å‹• |

### 6.2 ä¿®æ­£å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | ä¿®æ­£å†…å®¹ | å½±éŸ¿åº¦ |
|------------|---------|-------|
| `lib/features/haiku/presentation/pages/haiku_input_page.dart` | `handleNext()`ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§`unawaited(saveHaiku())`è¿½åŠ  | ä½ |

**ä¿®æ­£ç®‡æ‰€ã®è©³ç´°** (L74-L81):
```dart
// ä¿®æ­£å‰
} else {
  GeneratingRoute(
    firstLine: firstLine.value,
    secondLine: secondLine.value,
    thirdLine: thirdLine.value,
  ).go(context);
}

// ä¿®æ­£å¾Œ
} else {
  // éåŒæœŸä¿å­˜ (UIã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ãªã„)
  final notifier = ref.read(haikuNotifierProvider.notifier);
  unawaited(
    notifier.saveHaiku(
      firstLine: firstLine.value,
      secondLine: secondLine.value,
      thirdLine: thirdLine.value,
    ),
  );

  // å³åº§ã«ç”»é¢é·ç§»
  GeneratingRoute(
    firstLine: firstLine.value,
    secondLine: secondLine.value,
    thirdLine: thirdLine.value,
  ).go(context);
}
```

**è¿½åŠ ã®import**:
```dart
import 'package:async/async.dart'; // unawaitedç”¨
import 'package:hooks_riverpod/hooks_riverpod.dart'; // refç”¨ (æ—¢å­˜)
import '../providers/haiku_provider.dart'; // æ–°è¦
```

**HookWidgetã‹ã‚‰HookConsumerWidgetã¸ã®å¤‰æ›´**:
```dart
// ä¿®æ­£å‰
class HaikuInputPage extends HookWidget {
  const HaikuInputPage({super.key});

  @override
  Widget build(BuildContext context) {
    // ...
  }
}

// ä¿®æ­£å¾Œ
class HaikuInputPage extends HookConsumerWidget {
  const HaikuInputPage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // ref ã‚’ä½¿ç”¨å¯èƒ½ã«
  }
}
```

### 6.3 æ—¢å­˜ãƒ†ã‚¹ãƒˆã¸ã®å½±éŸ¿

**ãƒ•ã‚¡ã‚¤ãƒ«**: `test/features/haiku/presentation/pages/haiku_input_page_test.dart`

**å½±éŸ¿å†…å®¹**:
- Riverpodãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒ¢ãƒƒã‚¯åŒ–ãŒå¿…è¦
- `ProviderScope`ã§ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’ãƒ©ãƒƒãƒ—
- ä¿å­˜å‡¦ç†ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã“ã¨ã®æ¤œè¨¼

**ä¿®æ­£ç®‡æ‰€ä¾‹**:
```dart
testWidgets('ã‚¹ãƒ†ãƒƒãƒ—2ã§æ±ºå®šã™ã‚‹ã¨Firestoreä¿å­˜ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹', (tester) async {
  // Arrange
  final container = ProviderContainer(
    overrides: [
      haikuNotifierProvider.overrideWith(() => MockHaikuNotifier()),
    ],
  );

  await tester.pumpWidget(
    UncontrolledProviderScope(
      container: container,
      child: const MaterialApp(home: HaikuInputPage()),
    ),
  );

  // Act
  // ... 3ã‚¹ãƒ†ãƒƒãƒ—å…¥åŠ› ...

  // Assert
  verify(mockNotifier.saveHaiku(
    firstLine: any,
    secondLine: any,
    thirdLine: any,
  )).called(1);
});
```

### 6.4 ä»–ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã¸ã®å½±éŸ¿

**å½±éŸ¿ç¯„å›²**: **ãªã—**

**ç†ç”±**:
- å®Ÿè£…ã¯haikuãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼å†…ã§å®Œçµ
- Sharedå±¤ã¸ã®å¤‰æ›´ãªã—
- ä»–ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã‹ã‚‰haikuã¸ã®ä¾å­˜ãªã— (Featureâ†’Featureä¾å­˜ã¯ç¦æ­¢)

**æ—¢å­˜ã®ç”»é¢é·ç§»ãƒ•ãƒ­ãƒ¼**:
```
PostsPage â†’ CreateRoute â†’ HaikuInputPage â†’ GeneratingRoute â†’ PreviewRoute
```

**å¤‰æ›´å¾Œ**:
```
PostsPage â†’ CreateRoute â†’ HaikuInputPage â†’ [Firestoreä¿å­˜] â†’ GeneratingRoute â†’ PreviewRoute
                                              â†“
                                          (ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰)
```

---

## 7. æŠ€è¡“çš„ãƒªã‚¹ã‚¯ã¨èª²é¡Œ

### 7.1 ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ãƒªã‚¹ã‚¯

**ãƒªã‚¹ã‚¯**: Firestoreä¿å­˜ã¨ç”»é¢é·ç§»ãŒéåŒæœŸã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€ä¿å­˜å¤±æ•—æ™‚ã®æ•´åˆæ€§å•é¡Œ

**ã‚·ãƒŠãƒªã‚ª**:
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä¿³å¥ã‚’3è¡Œå…¥åŠ›
2. `saveHaiku()`ãŒé–‹å§‹ã•ã‚Œã‚‹ãŒã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã§å¤±æ•—
3. åŒæ™‚ã«`GeneratingRoute`ã¸ç”»é¢é·ç§»å®Œäº†
4. AIç”»åƒç”ŸæˆãŒæˆåŠŸã—ã€`PreviewRoute`ã¸é·ç§»
5. çµæœ: ç”»åƒã¯ç”Ÿæˆã•ã‚ŒãŸãŒã€ä¿³å¥ãƒ‡ãƒ¼ã‚¿ãŒFirestoreã«å­˜åœ¨ã—ãªã„

**ç·©å’Œç­–**:
1. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å¼·åŒ–**:
   ```dart
   try {
     final docId = await notifier.saveHaiku(...);
     // ä¿å­˜æˆåŠŸæ™‚ã®å‡¦ç†
   } catch (e) {
     // ã‚¨ãƒ©ãƒ¼é€šçŸ¥ (Snackbarç­‰)
     // ãƒªãƒˆãƒ©ã‚¤ã‚ªãƒ—ã‚·ãƒ§ãƒ³æä¾›
   }
   ```

2. **ä¿å­˜çŠ¶æ…‹ã®ç›£è¦–**:
   ```dart
   ref.listen(haikuNotifierProvider, (previous, next) {
     next.when(
       data: (_) => null, // æˆåŠŸæ™‚ä½•ã‚‚ã—ãªã„
       loading: () => null,
       error: (error, stack) {
         // ã‚¨ãƒ©ãƒ¼æ™‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥
         ScaffoldMessenger.of(context).showSnackBar(
           SnackBar(content: Text('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: $error')),
         );
       },
     );
   });
   ```

3. **å°†æ¥çš„ãªæ”¹å–„**:
   - ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¸ã®ä¸€æ™‚ä¿å­˜
   - ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰åŒæœŸæ©Ÿèƒ½ã®å®Ÿè£…
   - ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ

**ç¾æ™‚ç‚¹ã§ã®å¯¾å¿œ**: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥ã‚’å®Ÿè£…

### 7.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ãƒªã‚¹ã‚¯

**ãƒªã‚¹ã‚¯**: Firestoreæ›¸ãè¾¼ã¿é…å»¶ã«ã‚ˆã‚‹UXä½ä¸‹

**åˆ†æ**:
- `unawaited()`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€UIã¯ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œãªã„
- ç”»é¢é·ç§»ã¯å³åº§ã«å®Ÿè¡Œã•ã‚Œã‚‹
- å®Ÿè³ªçš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å½±éŸ¿ã¯**ä½ã„**

**æ¸¬å®šãƒã‚¤ãƒ³ãƒˆ**:
- Firestoreæ›¸ãè¾¼ã¿ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· (é€šå¸¸100-300ms)
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ³ã«ã‚ˆã‚‹å¤‰å‹•

**ç›£è¦–æ–¹æ³•**:
```dart
final stopwatch = Stopwatch()..start();
await repository.create(haiku);
stopwatch.stop();
logger.d('Firestore write took ${stopwatch.elapsedMilliseconds}ms');
```

### 7.3 ãƒ†ã‚¹ãƒˆã®è¤‡é›‘æ€§

**èª²é¡Œ**: Riverpodãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¨ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã®çµ±åˆãƒ†ã‚¹ãƒˆ

**å¯¾å¿œç­–**:
1. **ãƒ¢ãƒƒã‚¯åŒ–ã®æ¨™æº–åŒ–**:
   ```dart
   class MockHaikuNotifier extends Notifier<AsyncValue<void>>
       with Mock implements HaikuNotifier {}
   ```

2. **ãƒ†ã‚¹ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼ã®ä½œæˆ**:
   ```dart
   Widget createTestWidget({
     required Widget child,
     List<Override> overrides = const [],
   }) {
     return ProviderScope(
       overrides: overrides,
       child: MaterialApp(home: child),
     );
   }
   ```

3. **æ—¢å­˜ãƒ†ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨**:
   - `firestore_repository_test.dart`ã‚’å‚è€ƒã«ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆ
   - `haiku_input_page_test.dart`ã«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒ¢ãƒƒã‚¯ã‚’è¿½åŠ 

### 7.4 ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã®ä¾å­˜é–¢ä¿‚

**èª²é¡Œ**: `build_runner`ã«ã‚ˆã‚‹è‡ªå‹•ç”Ÿæˆã‚³ãƒ¼ãƒ‰ã®ç®¡ç†

**å¯¾å¿œ**:
1. **ç”Ÿæˆã‚³ãƒãƒ³ãƒ‰ã®æ¨™æº–åŒ–**:
   ```bash
   fvm flutter pub run build_runner build --delete-conflicting-outputs
   ```

2. **ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª**:
   - `*.g.dart`ãƒ•ã‚¡ã‚¤ãƒ«ãŒgitignoreã«å«ã¾ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª
   - ã‚³ãƒŸãƒƒãƒˆå‰ã«å¿…ãšç”Ÿæˆã‚’å®Ÿè¡Œ

3. **CI/CDã§ã®è‡ªå‹•åŒ–**:
   ```yaml
   - name: Generate code
     run: fvm flutter pub run build_runner build --delete-conflicting-outputs
   ```

---

## 8. ä¾å­˜é–¢ä¿‚ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª

### 8.1 å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

**`pubspec.yaml`ç¢ºèªçµæœ**:

| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | å¿…è¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | çŠ¶æ…‹ |
|----------|--------------|----------------|------|
| `cloud_firestore` | >=4.0.0 | 6.1.0 | âœ… åˆ©ç”¨å¯èƒ½ |
| `hooks_riverpod` | >=3.0.0 | 3.0.3 | âœ… åˆ©ç”¨å¯èƒ½ |
| `riverpod_annotation` | >=3.0.0 | 3.0.3 | âœ… åˆ©ç”¨å¯èƒ½ |
| `freezed_annotation` | >=3.0.0 | 3.1.0 | âœ… åˆ©ç”¨å¯èƒ½ |
| `json_annotation` | >=4.0.0 | 4.9.0 | âœ… åˆ©ç”¨å¯èƒ½ |
| `async` | >=2.0.0 | 2.11.0 | âœ… åˆ©ç”¨å¯èƒ½ |

**dev_dependencies**:

| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | å¿…è¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | çŠ¶æ…‹ |
|----------|--------------|----------------|------|
| `build_runner` | >=2.0.0 | 2.6.0 | âœ… åˆ©ç”¨å¯èƒ½ |
| `riverpod_generator` | >=3.0.0 | 3.0.3 | âœ… åˆ©ç”¨å¯èƒ½ |
| `freezed` | >=3.0.0 | 3.2.3 | âœ… åˆ©ç”¨å¯èƒ½ |
| `json_serializable` | >=6.0.0 | 6.11.1 | âœ… åˆ©ç”¨å¯èƒ½ |
| `fake_cloud_firestore` | >=4.0.0 | 4.0.0 | âœ… åˆ©ç”¨å¯èƒ½ |

**çµè«–**: è¿½åŠ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã€‚æ—¢å­˜ã®ä¾å­˜é–¢ä¿‚ã§å®Ÿè£…å¯èƒ½ã€‚

### 8.2 Firebaseè¨­å®šã®ç¢ºèª

**å¿…è¦ãªè¨­å®š**:
- Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ (å®Œäº†æ¸ˆã¿æƒ³å®š)
- Cloud Firestore ã®æœ‰åŠ¹åŒ–
- Firebase SDK ã®åˆæœŸåŒ– (`FirebaseService`)

**ç¢ºèªé …ç›®**:
```dart
// lib/shared/service/firebase_service.dart
class FirebaseService {
  static FirebaseFirestore get firestore => FirebaseFirestore.instance;
}
```

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«**:
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /haikus/{haikuId} {
      // ä½œæˆ: èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿
      allow create: if request.auth != null;

      // èª­ã¿å–ã‚Š: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼
      allow read: if true;

      // æ›´æ–°ãƒ»å‰Šé™¤: ä½œæˆè€…ã®ã¿ (å°†æ¥çš„ã«å®Ÿè£…)
      allow update, delete: if request.auth != null
                            && request.auth.uid == resource.data.userId;
    }
  }
}
```

**æ³¨æ„**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã¯Firebaseã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

---

## 9. å®Ÿè£…æ¨å¥¨äº‹é …

### 9.1 å„ªå…ˆé †ä½ä»˜ãå®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

**Phase 1: ãƒ‡ãƒ¼ã‚¿å±¤ã®å®Ÿè£…** (å¿…é ˆ)
1. `HaikuModel`ã®ä½œæˆ (Freezed + json_serializable)
2. `HaikuRepository`ã®å®Ÿè£… (FirestoreRepositoryç¶™æ‰¿)
3. ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ä½œæˆ

**Phase 2: çŠ¶æ…‹ç®¡ç†å±¤ã®å®Ÿè£…** (å¿…é ˆ)
4. `HaikuNotifier`ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ä½œæˆ
5. `saveHaiku()`ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
6. ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

**Phase 3: UIçµ±åˆ** (å¿…é ˆ)
7. `HaikuInputPage`ã®ä¿®æ­£ (HookWidget â†’ HookConsumerWidget)
8. `handleNext()`ãƒ¡ã‚½ãƒƒãƒ‰ã¸ã®ä¿å­˜å‡¦ç†è¿½åŠ 
9. ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®æ›´æ–°

**Phase 4: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** (æ¨å¥¨)
10. ä¿å­˜å¤±æ•—æ™‚ã®ã‚¨ãƒ©ãƒ¼é€šçŸ¥å®Ÿè£…
11. ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ã®æ¤œè¨
12. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®æ”¹å–„

**Phase 5: å“è³ªä¿è¨¼** (å¿…é ˆ)
13. ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã®å®Ÿè¡Œã¨ç¢ºèª
14. é™çš„è§£æ (`fvm flutter analyze`)
15. å…¨ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ (`fvm flutter test`)
16. æ‰‹å‹•ãƒ†ã‚¹ãƒˆ (å®Ÿæ©Ÿ/ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿)

### 9.2 ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

**å‘½åè¦å‰‡**:
- ãƒ¢ãƒ‡ãƒ«: `HaikuModel` (Freezedã‚¯ãƒ©ã‚¹ã®æ…£ç¿’)
- ãƒªãƒã‚¸ãƒˆãƒª: `HaikuRepository`
- ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼: `HaikuNotifier`, `haikuNotifierProvider` (ç”Ÿæˆ)

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**:
- å…¨public APIã«æ—¥æœ¬èªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚³ãƒ¡ãƒ³ãƒˆ (`///`)
- è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã«ã¯å®Ÿè£…ã‚³ãƒ¡ãƒ³ãƒˆ
- Issueã¨ã®ç´ä»˜ã‘ã‚³ãƒ¡ãƒ³ãƒˆ

**ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**:
```dart
try {
  final docId = await repository.create(haiku);
  logger.i('Haiku saved successfully: $docId');
  return docId;
} catch (e, stackTrace) {
  logger.e('Failed to save haiku', error: e, stackTrace: stackTrace);
  state = AsyncValue.error(e, stackTrace);
  rethrow;
}
```

**ãƒ­ã‚®ãƒ³ã‚°**:
- `logger`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½¿ç”¨ (æ—¢å­˜ä¾å­˜é–¢ä¿‚)
- ä¿å­˜æˆåŠŸ/å¤±æ•—ã®ãƒ­ã‚°å‡ºåŠ›
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®è¨˜éŒ²

### 9.3 ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

**ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**:
- `HaikuModel`: JSONå¤‰æ›ã€ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ“ãƒªãƒ†ã‚£
- `HaikuRepository`: å…¨CRUDãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹
- `HaikuNotifier`: `saveHaiku()`ã®æˆåŠŸ/å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³

**ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**:
- `HaikuInputPage`: ä¿å­˜å‡¦ç†ã®å‘¼ã³å‡ºã—æ¤œè¨¼
- ã‚¨ãƒ©ãƒ¼æ™‚ã®UIè¡¨ç¤ºç¢ºèª

**çµ±åˆãƒ†ã‚¹ãƒˆ** (å°†æ¥çš„):
- ä¿³å¥å…¥åŠ› â†’ ä¿å­˜ â†’ ç”»é¢é·ç§»ã®å…¨ãƒ•ãƒ­ãƒ¼
- Firebaseã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã¨ã®é€£æº

### 9.4 å¿…é ˆã‚³ãƒãƒ³ãƒ‰ã‚·ãƒ¼ã‚±ãƒ³ã‚¹

**å®Ÿè£…ä¸­**:
```bash
# ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ (æ¨å¥¨)
fvm flutter pub run build_runner watch --delete-conflicting-outputs
```

**å®Ÿè£…å®Œäº†å¾Œ**:
```bash
# ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
fvm flutter pub run build_runner build --delete-conflicting-outputs

# é™çš„è§£æ
fvm flutter analyze

# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
dart format --set-exit-if-changed .

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
fvm flutter test

# ã‚¢ãƒ—ãƒªå®Ÿè¡Œ
fvm flutter run
```

---

## 10. æ¨å¥¨ã•ã‚Œã‚‹æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚º

### PLAN Phase ã¸ã®ç§»è¡Œ

**æº–æ‹ æ€§**: âœ… ä¸‰å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«å®Œå…¨æº–æ‹ 
**å®Ÿè£…å¯èƒ½æ€§**: âœ… æ—¢å­˜ã‚¤ãƒ³ãƒ•ãƒ©ã§å®Ÿè£…å¯èƒ½
**ãƒªã‚¹ã‚¯**: ğŸŸ¡ ä¸­ç¨‹åº¦ (ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¦)
**æ¨å¥¨**: **PLANãƒ•ã‚§ãƒ¼ã‚ºã¸ã®ç§»è¡Œã‚’æ¨å¥¨**

**PLANãƒ•ã‚§ãƒ¼ã‚ºã§æ±ºå®šã™ã¹ãäº‹é …**:
1. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å…·ä½“çš„ãªå®Ÿè£…æ–¹æ³•
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ–¹æ³• (Snackbar, Dialogç­‰)
3. ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ã®å®Ÿè£…ç¯„å›²
4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ã®å®Ÿè£…æ–¹æ³•
5. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã®è©³ç´°è¨­è¨ˆ

**IMPLEMENTãƒ•ã‚§ãƒ¼ã‚ºã§ã®ä½œæ¥­å†…å®¹**:
- ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…
- ãƒªãƒã‚¸ãƒˆãƒªã®å®Ÿè£…
- ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®å®Ÿè£…
- UIçµ±åˆ
- ãƒ†ã‚¹ãƒˆã®ä½œæˆã¨å®Ÿè¡Œ
- å“è³ªã‚²ãƒ¼ãƒˆã®ãƒ‘ã‚¹

**TESTãƒ•ã‚§ãƒ¼ã‚ºã§ã®æ¤œè¨¼é …ç›®**:
- å…¨ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ãƒ‘ã‚¹
- å…¨ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ãƒ‘ã‚¹
- é™çš„è§£æã®ãƒ‘ã‚¹
- å®Ÿæ©Ÿã§ã®å‹•ä½œç¢ºèª
- ã‚¨ãƒ©ãƒ¼ã‚·ãƒŠãƒªã‚ªã®æ¤œè¨¼

---

## 11. è£œè¶³æƒ…å ±

### 11.1 å‚è€ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…**:
- `CLAUDE.md`: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ã¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
- `docs/ARCHITECTURE.md`: ä¸‰å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°
- `docs/STYLE_GUIDE.md`: ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰

**æ—¢å­˜å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**:
- `lib/shared/data/repositories/firestore_repository.dart`: ãƒªãƒã‚¸ãƒˆãƒªåŸºåº•ã‚¯ãƒ©ã‚¹
- `lib/app/app_di/nickname_provider.dart`: Riverpodãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³
- `test/shared/data/repositories/firestore_repository_test.dart`: ãƒªãƒã‚¸ãƒˆãƒªãƒ†ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³

**Firebase**:
- Firestore ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://firebase.google.com/docs/firestore
- Flutterfire ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://firebase.flutter.dev/

**ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸**:
- Riverpod 3.x: https://riverpod.dev/
- Freezed: https://pub.dev/packages/freezed
- go_router: https://pub.dev/packages/go_router

### 11.2 Issue #38 ã¨ã®å·®åˆ†

**Issueææ¡ˆã¨ã®ä¸»ãªé•ã„**:

1. **ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å**:
   - Issue: `firstLine`, `secondLine`, `thirdLine`
   - ç¾å®Ÿè£…: `firstLine`, `secondLine`, `thirdLine` (ä¸€è‡´)

2. **ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å**:
   - Issue: `'haikus'`
   - æ¨å¥¨: `'haikus'` (ä¸€è‡´)

3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**:
   - Issue: åŸºæœ¬çš„ãªå®Ÿè£…ã®ã¿
   - æ¨å¥¨: ã‚ˆã‚Šè©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥

4. **ãƒ†ã‚¹ãƒˆè¦ä»¶**:
   - Issue: Unit Test + Widget Test
   - æ¨å¥¨: åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ + çµ±åˆãƒ†ã‚¹ãƒˆæ¤œè¨

### 11.3 å°†æ¥çš„ãªæ‹¡å¼µã®å¯èƒ½æ€§

**Issue #38å®Œäº†å¾Œã«å¯èƒ½ã«ãªã‚‹æ©Ÿèƒ½**:
1. ä¿³å¥å±¥æ­´ã®è¡¨ç¤º (Firestoreã‹ã‚‰å–å¾—)
2. ä¿³å¥ã®ç·¨é›†æ©Ÿèƒ½ (updateæ“ä½œ)
3. ä¿³å¥ã®å‰Šé™¤æ©Ÿèƒ½ (deleteæ“ä½œ)
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®ä¿³å¥ç®¡ç† (userId ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ´»ç”¨)
5. ã„ã„ã­æ©Ÿèƒ½ (likeCountè¿½åŠ )
6. ä¿³å¥ã®æ¤œç´¢ã¨ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ‹¡å¼µ**:
- `haiku`ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã«`service`å±¤ã‚’è¿½åŠ 
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®åˆ†é›¢ (ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€å¤‰æ›ç­‰)
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã®å®Ÿè£…

---

## 12. çµè«–

### èª¿æŸ»çµæœã‚µãƒãƒªãƒ¼

**å®Ÿè£…å¯èƒ½æ€§**: âœ… **é«˜**
- æ—¢å­˜ã‚¤ãƒ³ãƒ•ãƒ©(`FirestoreRepository`)ãŒå®Œå‚™
- å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå…¨ã¦å°å…¥æ¸ˆã¿
- æ˜ç¢ºãªå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç¢ºç«‹æ¸ˆã¿

**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æº–æ‹ æ€§**: âœ… **å®Œå…¨æº–æ‹ **
- ä¸‰å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«é•åãªã—
- Featureå†…ã§å®Œçµã™ã‚‹å®Ÿè£…
- ä»–ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã¸ã®å½±éŸ¿ã‚¼ãƒ­

**æŠ€è¡“çš„ãƒªã‚¹ã‚¯**: ğŸŸ¡ **ä¸­ç¨‹åº¦**
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…ãŒå¿…è¦
- ãƒ†ã‚¹ãƒˆã®è¤‡é›‘æ€§ãŒè‹¥å¹²å¢—åŠ 
- é©åˆ‡ãªç·©å’Œç­–ãŒå­˜åœ¨

**å®Ÿè£…å„ªå…ˆåº¦**: âœ… **é«˜**
- ä¿³å¥ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã¯é‡è¦æ©Ÿèƒ½
- å°†æ¥çš„ãªæ©Ÿèƒ½æ‹¡å¼µã®åŸºç›¤ã¨ãªã‚‹
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®å¤§å¹…ãªæ”¹å–„

### æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

1. **PLANãƒ•ã‚§ãƒ¼ã‚ºã¸ã®ç§»è¡Œ**: âœ… æ¨å¥¨
2. **feature/issue-38-haiku-firestore-save ãƒ–ãƒ©ãƒ³ãƒã®ä½œæˆ**: å¿…é ˆ
3. **æ®µéšçš„ãªå®Ÿè£…**: ãƒ‡ãƒ¼ã‚¿å±¤ â†’ çŠ¶æ…‹ç®¡ç†å±¤ â†’ UIçµ±åˆ
4. **åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆ**: ãƒ¦ãƒ‹ãƒƒãƒˆ + ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ + æ‰‹å‹•ãƒ†ã‚¹ãƒˆ

### å®Œäº†åŸºæº–

**INVESTIGATE ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†æ¡ä»¶**:
- âœ… æ—¢å­˜å®Ÿè£…ã®ç†è§£å®Œäº†
- âœ… ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æº–æ‹ æ€§ã®æ¤œè¨¼å®Œäº†
- âœ… å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç‰¹å®šå®Œäº†
- âœ… ãƒªã‚¹ã‚¯ã®æ´—ã„å‡ºã—å®Œäº†
- âœ… èª¿æŸ»çµæœã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–å®Œäº†

**æ¬¡ãƒ•ã‚§ãƒ¼ã‚º**: **PLAN**

---

**èª¿æŸ»å®Œäº†æ—¥æ™‚**: 2025-11-30
**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆè€…**: Claude Code
